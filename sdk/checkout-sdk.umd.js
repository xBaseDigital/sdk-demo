(function(t,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(t=typeof globalThis<"u"?globalThis:t||self,o(t.CheckoutSDK={}))})(this,function(t){"use strict";const o=async({grant_type:s,client_id:a,client_secret:c})=>{try{const e=new URLSearchParams;e.append("grant_type",s),e.append("client_id",a),e.append("client_secret",c);const n=await(await fetch("https://pay-sandbox.xbase.digital/identity/api/Authentication/connect/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e.toString()})).json();if(!n.access_token)throw new Error("Failed to obtain access token");return n.access_token}catch(e){throw console.error("Authentication error:",e),e}},d=async(s,a,c)=>{try{const e={...s,merchantLocationId:c},r=await fetch("https://pay-sandbox.xbase.digital/api/orders/authorize",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(e)});if(!r.ok){const h=await r.text();return console.error("Error processing checkout:",h),{success:!1,error:h}}const n=await r.json();return console.log("Checkout result:",n),window.location.href=`https://checkout.staging.xbd.app/select-currency?orderId=${n.orderId}`,{success:!0,data:n}}catch(e){return console.error("Checkout error:",e),{success:!1,error:e.message}}};let i=null;function u({grant_type:s,client_id:a,client_secret:c,merchantLocationId:e}){return i||(i={grant_type:s,client_id:a,client_secret:c,merchantLocationId:e,token:null,async authenticate(){return this.token||(this.token=await o({grant_type:this.grant_type,client_id:this.client_id,client_secret:this.client_secret})),this.token},async checkout(r){const n=await this.authenticate();return d(r,n,this.merchantLocationId)}},console.log("SDK Initialized with:",i),i)}typeof window<"u"&&(window.MyCheckoutSDK={init:u});const l={initGlobalSdk:u,authenticate:o,processCheckout:d};t.authenticate=o,t.default=l,t.initGlobalSdk=u,t.processCheckout=d,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
